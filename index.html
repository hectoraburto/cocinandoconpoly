<!DOCTYPE html>
<html lang="es-CL">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cocinando con Poly ‚Äî Sabor que conquista</title>
  <meta name="description" content="Men√∫ semanal de almuerzos caseros, postres y opci√≥n vegetariana personalizada TODOS LOS DIAS. Pide por WhatsApp dentro del condominio." />
  <meta name="theme-color" content="#f97316" />

  <!-- Open Graph / Twitter -->
  <meta property="og:title" content="Cocinando con Poly ‚Äî Almuerzos caseros en tu condominio" />
  <meta property="og:description" content="Men√∫ semanal, platos caseros, postres y vegetariano. Pide por WhatsApp." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://hectoraburto.github.io/cocinandoconpoly/" />
  <meta property="og:image" content="https://hectoraburto.github.io/cocinandoconpoly/img/og.png?v=2" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Cocinando con Poly ‚Äî Platos caseros en el condominio" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Cocinando con Poly ‚Äî Almuerzos caseros en tu condominio" />
  <meta name="twitter:description" content="Men√∫ semanal, platos caseros, postres y vegetariano. Pide por WhatsApp." />
  <meta name="twitter:image" content="https://hectoraburto.github.io/cocinandoconpoly/img/og.png?v=2" />
  <link rel="canonical" href="https://hectoraburto.github.io/cocinandoconpoly/" />

  <!-- Icons / PWA -->
  <link rel="icon" href="./favicon.ico" sizes="any" />
  <link rel="icon" type="image/png" sizes="32x32" href="./img/favicon-32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="./img/favicon-16.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="./img/apple-touch-icon.png" />
  <link rel="manifest" href="./site.webmanifest" />

  <style>
    :root{ --brand:#f97316; --brand-600:#ea580c; --ink:#141414; --muted:#6b7280; --bg:#fffdf9; --card:#ffffff; --shadow:0 10px 25px rgba(0,0,0,.07); --radius:16px; --header-bg:#fff7ed; --header-fg:#0f172a }
    *{box-sizing:border-box}
    html,body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial;color:var(--ink);background:var(--bg)}
    a{color:var(--brand-600);text-decoration:none}
    img{max-width:100%;height:auto;border-radius:var(--radius)}
    .container{width:min(1100px,92%);margin-inline:auto}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    header{position:sticky;top:0;z-index:50;background:var(--header-bg);color:var(--header-fg);border-bottom:1px solid #e5e7eb;backdrop-filter:saturate(1.1) blur(6px)}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:.8rem 0}
    .brand{display:flex;align-items:center;gap:.7rem;font-weight:800}
    .brand img{display:none} /* logo ahora s√≥lo en el footer */
    .menu{display:flex;gap:1rem;align-items:center}
    .cta{display:inline-flex;align-items:center;gap:.5rem;background:var(--brand);color:#fff;padding:.55rem .9rem;border-radius:999px;font-weight:700;box-shadow:var(--shadow)}
    .cta:hover{background:var(--brand-600)}

    section{padding:1.6rem 0}
    h1{font-size:clamp(1.8rem,2.5vw + 1rem,2.8rem);line-height:1.1;margin:.2rem 0 .8rem}
    h2{font-size:1.6rem;margin:.2rem 0 1rem}
    .note{background:#fff;border:1px dashed #e5e7eb;padding:.8rem 1rem;border-radius:12px;color:#374151}
    .chips{display:flex;gap:.5rem;flex-wrap:wrap;margin:.8rem 0 1rem}
    .chip{background:#fff;border:1px solid #eee;padding:.35rem .6rem;border-radius:999px;font-size:.9rem;color:#374151}

    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:1rem}
    .col-12{grid-column:span 12} .col-6{grid-column:span 6} .col-4{grid-column:span 4}
    @media (max-width:920px){.col-6,.col-4{grid-column:span 12}}

    .card{background:var(--card);border:1px solid #eee;padding:1rem;border-radius:var(--radius);box-shadow:var(--shadow)}
    .dish{display:flex;gap:1rem}
    .price{font-weight:800;color:var(--brand)}
    .badge{font-size:.8rem;padding:.18rem .5rem;border-radius:6px;background:#f1f5f9;color:#111;margin-left:.35rem}
    .btn{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .8rem;border-radius:10px;border:1px solid #e5e7eb;background:#fff;font-weight:600;cursor:pointer}
    .btn.primary{background:var(--brand);color:#fff;border-color:transparent}.btn.primary:hover{background:var(--brand-600)}

    /* Carrusel */
    .carousel{position:relative;overflow:hidden;border-radius:var(--radius);border:1px solid #eee;background:#fff;box-shadow:var(--shadow)}
    .track{display:flex;transition:transform .6s ease;will-change:transform}
    .slide{min-width:100%;display:grid;grid-template-columns:1fr 1fr;gap:1rem;padding:1rem}
    .slide img{width:100%;height:240px;object-fit:cover}
    .controls{position:absolute;inset:0;display:flex;align-items:center;justify-content:space-between;pointer-events:none}
    .controls button{pointer-events:auto;border:none;background:rgba(0,0,0,.45);color:#fff;width:42px;height:42px;border-radius:999px;display:grid;place-items:center;margin:0 .5rem}
    .dots{position:absolute;bottom:.6rem;left:0;right:0;display:flex;justify-content:center;gap:.4rem}
    .dots button{width:9px;height:9px;border-radius:999px;border:none;background:#e5e7eb}
    .dots button[aria-selected="true"]{background:var(--brand)}
    @media (max-width:900px){.slide{grid-template-columns:1fr}.slide img{height:200px}}

    /* Efecto visual en cartas del men√∫ */
    .dish.card{position:relative;border:1px solid #eee;transition:transform .2s ease, box-shadow .2s ease}
    .dish.card:hover{transform:translateY(-4px);box-shadow:0 12px 28px rgba(0,0,0,.12)}
    .dish.card::after{content:"";position:absolute;inset:0;border-radius:var(--radius);padding:1px;background:linear-gradient(135deg, rgba(249,115,22,.45), rgba(234,88,12,.1));-webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);-webkit-mask-composite:xor;mask-composite:exclude}

    /* Destacar secci√≥n Vegetariano */
    #vegetariano{background:#fffbeb;border-top:1px solid #fde68a;border-bottom:1px solid #fde68a}
    #vegetariano h2{display:flex;align-items:center;gap:.5rem}
    #vegetariano h2::after{content:"‚òÖ Destacado";font-size:.9rem;background:#f59e0b;color:#111;padding:.2rem .5rem;border-radius:6px}

    /* Footer */
    footer{background:#0f172a;color:#e2e8f0;margin-top:2rem}
    footer a{color:#93c5fd}
    .footer-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem;padding:1.1rem 0}
    @media (max-width:720px){.footer-grid{grid-template-columns:1fr}}

    /* FAB WhatsApp (m√≥vil) */
    .fab-wa{position:fixed;right:16px;bottom:18px;z-index:999;display:inline-flex;align-items:center;justify-content:center;width:56px;height:56px;border-radius:999px;background:#25D366;color:#fff;font-weight:700;text-decoration:none;box-shadow:0 10px 25px rgba(0,0,0,.18)}
    @media (min-width:900px){.fab-wa{display:none}}
  </style>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FoodEstablishment",
    "name": "Cocinando con Poly",
    "url": "https://hectoraburto.github.io/cocinandoconpoly/",
    "image": "https://hectoraburto.github.io/cocinandoconpoly/img/og.png",
    "telephone": "+56 9 4295 5777",
    "servesCuisine": ["Comida casera", "Chilena"],
    "priceRange": "$",
    "areaServed": "Entrega interna en condominio",
    "hasMenu": "https://hectoraburto.github.io/cocinandoconpoly/#menu",
    "offers": [{ "@type": "Offer", "name": "Almuerzo del d√≠a", "price": "5000", "priceCurrency": "CLP", "availability": "https://schema.org/InStock" }]
  }
  </script>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container nav">
      <div class="brand">
        <div>
          <div style="font-size:1.05rem">Cocinando con Poly</div>
          <div style="font-size:.9rem;color:#475569">Sabor que conquista</div>
        </div>
      </div>
      <nav class="menu" aria-label="Navegaci√≥n principal">
        <a href="#menu">Men√∫</a>
        <a href="#postres">Postres</a>
        <a href="#vegetariano">Vegetarianos</a>
        <a class="cta" id="btnHeader" href="#">Pedir por WhatsApp</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- HERO con imagen vegetariana -->
    <section class="container" id="hero">
      <div class="grid">
        <div class="col-6">
          <div class="note" id="stateBadge">‚óè <strong>Tomando pedidos ahora</strong></div>
          <h1>Men√∫ semanal con platos caseros, postres y opci√≥n vegetariana personalizada</h1>
          <p style="color:var(--muted);max-width:56ch">Entrega <strong>dentro del condominio</strong> entre 13:30 y 19:00. Reserva con anticipaci√≥n o pide el mismo d√≠a hasta agotar stock.</p>
          <div class="chips">
          <span class="chip">Depto 416 Torre B1</span>
          <span class="chip">Vegetarioanos TODOS LOS DIAS</span>
          <span class="chip">Transferencia / efectivo</span>
          
        </div>
        <div class="note">üí° Paola Andrea S√°nchez Torres RUT: 126342225 Mercado Pago Cuenta Vista N√∫mero de cuenta: 1051244960 polilla197417@gmail.com</em>.</div>
        <div style="margin-top:1rem">
          <a class="cta" id="btn-hero" href="#menu">Ver men√∫ y pedir</a>
        </div>
      </div>
        <div class="col-6">
          <div class="card">
            <img src="./img/vegetarianohuevoaceitunoquesoruculachoclo.jpg" alt="Oferta vegetariana: elige 4 ingredientes" />
          </div>
        </div>
      </div>
    </section>

    <!-- Banner Plato del d√≠a -->
    <section class="container" id="platoDelDia"></section>

    <!-- Carrusel recomendados -->
    <section class="container">
      <h2>Recomendados de la semana</h2>
      <div class="carousel" id="carousel" role="region" aria-label="Carrusel de recomendados">
        <div class="track" id="track"></div>
        <div class="controls">
          <button id="prev" aria-label="Anterior" aria-controls="track">‚Äπ</button>
          <button id="next" aria-label="Siguiente" aria-controls="track">‚Ä∫</button>
        </div>
        <div class="dots" id="dots" role="tablist" aria-label="P√°ginas del carrusel"></div>
        <div id="carouselLive" class="sr-only" aria-live="polite"></div>
      </div>
    </section>

    <!-- Men√∫ semanal -->
    <section class="container" id="menu">
      <h2>Men√∫ de Lunes a Viernes</h2>
      <div class="chips" id="tabs"></div>
      <div class="grid" id="dayContent"></div>
    </section>

    <!-- Postres -->
    <section class="container" id="postres">
      <h2>Postres</h2>
      <div class="grid" id="postresGrid"></div>
    </section>

    <!-- Vegetarianos (personaliza hasta 4 ingredientes) -->
    <section class="container" id="vegetariano">
      <h2>Vegetarianos ‚Äî arma tu plato (m√°x. 4 ingredientes)</h2>
      <div class="grid">
        <div class="col-6">
          <div class="card">
            <p style="margin:.2rem 0 1rem;color:var(--muted)">Marca hasta <strong>4</strong> ingredientes:</p>
            <form id="vegForm" class="grid" style="grid-template-columns:repeat(2,1fr);gap:.6rem"></form>
            <div class="note" style="margin-top:1rem">
              <div><strong id="countSel">0</strong>/4 seleccionados</div>
              <label for="vegNotes" style="display:block;margin-top:.6rem;font-weight:600">Comentarios / Sugerencias</label>
              <textarea id="vegNotes" rows="3" style="width:100%;padding:.6rem;border-radius:10px;border:1px solid #e5e7eb" placeholder="Me comentas el horario que lo necesitas"></textarea>
              <div style="display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.8rem">
                <a class="btn primary" id="vegWALink" href="#" aria-disabled="true">üì≤ Pedir por WhatsApp</a>
                <button class="btn" id="vegClear" type="button">Limpiar selecci√≥n</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-6">
          <div class="card">
            <img src="./img/cuatroingredientres.png" alt="Ensalada vegetariana" />
            <p class="sr-only">Imagen referencial de un plato vegetariano</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer con logo -->
  <footer>
    <div class="container footer-grid">
      <div style="display:flex;gap:1rem;align-items:center">
        <img src="./img/logo.png" alt="Logo Cocinando con Poly" style="width:56px;height:56px;object-fit:contain;border-radius:12px;box-shadow:var(--shadow)"/>
        <div>
          <div style="font-weight:800">Cocinando con Poly</div>
          <div style="font-size:.9rem;color:#cbd5e1">Hecho con ‚ù§ en el condominio ‚Äî ¬© <span id="year"></span></div>
        </div>
      </div>
      <div style="text-align:right">
        <div style="font-size:.9rem;color:#cbd5e1">Pedidos Lun‚ÄìVie ¬∑ 13:30‚Äì15:00 ¬∑ <a id="waFoot" href="#">WhatsApp</a></div>
      </div>
    </div>
  </footer>

  <!-- FAB WhatsApp (m√≥vil) -->
  <a id="fabWa" class="fab-wa" href="#" aria-label="Pedir por WhatsApp">WA</a>

  <script>
    // ===== CONFIGURACI√ìN =====
    const WHATSAPP_NUMBER = "+56942955777";
    const HORARIO = { abre:"10:00", cierra:"16:00" };
    const PRECIO_PLATO = 5000;
    const PRECIO_VEG   = 5000;

    // Men√∫ real de la semana
    let menuSemana = {
      "Lunes":     [{ nombre:"Charquic√°n con huevos", precio:PRECIO_PLATO, tags:["Casero"], img:"./img/charquicanconhuevo_cocinandoconpoly.jpg" }],
      "Martes":    [{ nombre:"Pollo con salsa bechamel y papas doradas y tomate cherry", precio:PRECIO_PLATO, tags:["Cremoso"], img:"./img/pollosalsabechamelpapasdoradastomatecherry.jpg" }],
      "Mi√©rcoles": [{ nombre:"Pastel de papas", precio:PRECIO_PLATO, tags:["Horno"], img:"./img/Pasteldepapas.jpg" }],
      "Jueves":    [{ nombre:"Chapsui de pollo con arroz chauf√°n", precio:PRECIO_PLATO, tags:["Salteado"], img:"./img/chapsuidePolloconArrozchaufan.jpg" }],
      "Viernes":   [{ nombre:"Pastel de choclo", precio:PRECIO_PLATO, tags:["Viernes"], img:"./img/pasteldechoclo.jpg" }]
    };

    // Postres (placeholder, reemplaza cuando tengas la lista final)
    const postres = [
     { nombre:"Pie de limon", precio:1000, img:"./img/piedelimon.png" },
     { nombre:"Arroz con tres leches", precio:1000, img:"./img/arrozcontresleches.png" },
    //  { nombre:"Leche asada", precio:2000, img:"https://images.unsplash.com/photo-1578985545062-69928b1d9587?q=80&w=1200&auto=format&fit=crop" },
     // { nombre:"Mote con huesillos", precio:2000, img:"https://images.unsplash.com/photo-1594041680534-e8c8d07f5518?q=80&w=1200&auto=format&fit=crop" }
    ];

    // Ingredientes vegetarianos (m√°ximo 4)
    const MAX_ING = 4;
    const ingredientes = [
      "Huevo","Aceituna","At√∫n","Camar√≥n","Champi√±ones","Tomate Cherry","Zanahoria","Choclo","Habas","Br√≥coli","Quinoa","Palmitos","Pepino","Zapallo italiano"
    ];

    // ===== UTILIDADES =====
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => [...el.querySelectorAll(sel)];
    const waBase = () => `https://wa.me/${WHATSAPP_NUMBER}`;
    const waText = (texto) => encodeURIComponent(texto);
    const precioFmt = (v) => `$${Intl.NumberFormat('es-CL').format(v)}`;

    function ahoraEnHorario(){
      const [ah, am] = new Date().toLocaleTimeString('es-CL',{hour12:false}).split(':');
      const ahora = Number(ah)*60 + Number(am);
      const [abH, abM] = HORARIO.abre.split(':').map(Number);
      const [ciH, ciM] = HORARIO.cierra.split(':').map(Number);
      const abre = abH*60 + abM; const cierra = ciH*60 + ciM;
      return ahora>=abre && ahora<=cierra;
    }

    function updateStateBadge(){
      const b = $('#stateBadge');
      if(!b) return;
      if(ahoraEnHorario()){
        b.style.background = '#ecfdf5'; b.style.borderColor = '#a7f3d0'; b.style.color = '#065f46';
        b.innerHTML = '‚óè <strong>Tomando pedidos ahora</strong>';
      } else {
        b.style.background = '#fff7ed'; b.style.borderColor = '#fed7aa'; b.style.color = '#7c2d12';
        b.innerHTML = '‚óè <strong>Fuera de horario</strong> ¬∑ deja tu reserva';
      }
    }

    // ===== MEN√ö (tabs y cards) =====
    function renderTabs(){
      const tabs = Object.keys(menuSemana);
      const cont = $('#tabs'); cont.innerHTML='';
      tabs.forEach((d,i)=>{
        const a = document.createElement('a');
        a.href = `#menu-${encodeURIComponent(d)}`;
        a.className = 'chip'; a.textContent = d;
        a.setAttribute('role','tab');
        a.setAttribute('aria-selected', i===0 ? 'true' : 'false');
        a.addEventListener('click', (e)=>{ e.preventDefault(); selectDay(d, a) });
        cont.appendChild(a);
      });
      selectDay(tabs[0], cont.firstChild);
    }

    function selectDay(dia, el){
      $$('#tabs .chip').forEach(c=>c.setAttribute('aria-selected','false'));
      el.setAttribute('aria-selected','true');
      renderDia(dia);
      location.hash = `#${encodeURIComponent(dia)}`;
    }

    function renderDia(dia){
      const cont = $('#dayContent'); cont.innerHTML='';
      const platos = menuSemana[dia]||[];
      if(!platos.length){ cont.innerHTML = `<p class="note col-12">Sin platos para <strong>${dia}</strong>.</p>`; return; }
      platos.forEach(p=>{
        const col = document.createElement('div'); col.className='col-6';
        col.innerHTML = `
          <article class="card dish">
            <img src="${p.img}" alt="${p.nombre}" width="140" height="100" loading="lazy" />
            <div>
              <h3 style="margin:.1rem 0 .35rem">${p.nombre} <span class="badge">${p.tags?.[0]||''}</span></h3>
              <div class="price">${precioFmt(p.precio)}</div>
              <div style="margin-top:.45rem;display:flex;gap:.5rem;flex-wrap:wrap">
                <a class="btn primary" target="_blank" rel="noopener" href="${waBase()}?text=${waText(`Hola Poly! Quiero pedir *${p.nombre}* para *${dia}*. Torre/Depto:`)}">üì≤ Pedir por WhatsApp</a>
              </div>
            </div>
          </article>`;
        cont.appendChild(col);
      });
    }

    // Plato del d√≠a
    function renderPlatoDelDia(){
      const dNames = ["Domingo","Lunes","Martes","Mi√©rcoles","Jueves","Viernes","S√°bado"];
      const today = new Date();
      const actual = dNames[today.getDay()];
      const usable = ["Lunes","Martes","Mi√©rcoles","Jueves","Viernes"].includes(actual) ? actual : "Lunes";
      const plato = (menuSemana[usable]||[])[0];
      const el = $('#platoDelDia');
      if(!plato){ el.innerHTML = ''; return; }
      el.innerHTML = `
        <div class="card" style="display:flex;gap:1rem;align-items:center;border-left:6px solid var(--brand)">
          <img src="${plato.img}" alt="${plato.nombre}" style="width:120px;height:90px;object-fit:cover"/>
          <div>
            <div class="chip">Plato del d√≠a ‚Äî <strong>${usable}</strong></div>
            <h3 style="margin:.2rem 0 .2rem">${plato.nombre}</h3>
            <div class="price">${precioFmt(plato.precio)}</div>
          </div>
          <div style="margin-left:auto">
            <a class="cta" target="_blank" rel="noopener" href="${waBase()}?text=${waText(`Hola Poly! Me interesa el *Plato del d√≠a (${plato.nombre})* para *${usable}*. Torre/Depto:`)}">Pedir ahora</a>
          </div>
        </div>`;
    }

    // Carrusel
    function renderCarousel(){
      const track=$('#track'), dots=$('#dots'), carousel=$('#carousel'), live=$('#carouselLive');
      const slides=[]; Object.entries(menuSemana).forEach(([d,pl])=>{ if(pl[0]) slides.push({dia:d, ...pl[0]}) });
      track.innerHTML=''; dots.innerHTML='';
      slides.forEach((s,i)=>{
        const node=document.createElement('div'); node.className='slide';
        node.setAttribute('role','group'); node.setAttribute('aria-roledescription','slide'); node.setAttribute('aria-label',`${i+1} de ${slides.length}: ${s.nombre}`);
        node.innerHTML=`<img src="${s.img}" alt="${s.nombre}"><div style="display:flex;flex-direction:column;gap:.6rem;justify-content:center"><div class="tiny">Recomendado de ${s.dia}</div><h3 style="margin:0">${s.nombre}</h3><div class="price">${precioFmt(s.precio)}</div><div><a class="cta" target="_blank" rel="noopener" href="${waBase()}?text=${waText(`Hola Poly! Quiero pedir *${s.nombre}* para *${s.dia}*. Torre/Depto:`)}">Quiero este</a></div></div>`;
        track.appendChild(node);
        const d=document.createElement('button'); d.setAttribute('role','tab'); d.setAttribute('aria-controls','track'); d.setAttribute('aria-label',`Ir a slide ${i+1}`); d.addEventListener('click',()=>go(i)); dots.appendChild(d);
      });
      let index=0,N=slides.length,timer=null; const reduce=matchMedia('(prefers-reduced-motion: reduce)').matches;
      function announce(){ if(live) live.textContent=`Mostrando ${index+1} de ${N}: ${slides[index].nombre}` }
      function updateDots(){ [...dots.querySelectorAll('button')].forEach((b,j)=> b.setAttribute('aria-selected', j===index?'true':'false')) }
      function go(i){ index=(i+N)%N; track.style.transform=`translateX(-${index*100}%)`; updateDots(); announce(); }
      function next(){ go(index+1) } function prev(){ go(index-1) }
      function reset(){ if(reduce) return; clearInterval(timer); timer=setInterval(next,4500) }
      document.getElementById('next').onclick=next; document.getElementById('prev').onclick=prev;
      carousel.addEventListener('mouseenter',()=>clearInterval(timer));
      carousel.addEventListener('focusin',()=>clearInterval(timer));
      carousel.addEventListener('mouseleave',reset);
      carousel.addEventListener('focusout',reset);
      carousel.addEventListener('keydown',(e)=>{ if(e.key==='ArrowRight'){e.preventDefault();next()} if(e.key==='ArrowLeft'){e.preventDefault();prev()} });
      carousel.setAttribute('tabindex','0');
      go(0); reset();
    }

    // Postres
    function renderPostres(){
      const grid=$('#postresGrid'); grid.innerHTML='';
      postres.forEach(p=>{
        const col=document.createElement('div'); col.className='col-4';
        col.innerHTML=`<article class="card"><img src="${p.img}" alt="${p.nombre}"/><h3 style="margin:.6rem 0 .2rem">${p.nombre}</h3><div class="price">${precioFmt(p.precio)}</div><div style="margin-top:.5rem"><a class="btn primary" target="_blank" rel="noopener" href="${waBase()}?text=${waText(`Hola Poly! Quiero pedir *${p.nombre}*. Torre/Depto:`)}">üì≤ Pedir por WhatsApp</a></div></article>`;
        grid.appendChild(col);
      });
    }

    // Vegetarianos
    function renderVeg(){
      const form=$('#vegForm'); form.innerHTML='';
      ingredientes.forEach((n,i)=>{
        const id=`ing-${i}`; const w=document.createElement('div');
        w.innerHTML=`<label style="display:flex;gap:.5rem;align-items:center"><input type="checkbox" id="${id}" name="ing" value="${n}"><span>${n}</span></label>`;
        form.appendChild(w.firstChild);
      });
      const countEl=$('#countSel'); const notes=$('#vegNotes'); const link=$('#vegWALink');
      function update(){
        const sel=$$('input[name="ing"]:checked').map(x=>x.value);
        countEl.textContent=sel.length;
        const unchecked=$$('input[name="ing"]:not(:checked)');
        unchecked.forEach(i=> i.disabled = sel.length>=MAX_ING);
        if(sel.length===0){ link.setAttribute('aria-disabled','true'); link.href='#'; return; }
        link.removeAttribute('aria-disabled');
        const txt=`Hola Poly! Quiero un *Vegetariano personalizable* con hasta 4 ingredientes. Eleg√≠: ${sel.join(', ')}. Comentarios: ${notes.value||'‚Äî'}. Total aprox: ${precioFmt(PRECIO_VEG)}. Torre/Depto:`;
        link.href = `${waBase()}?text=${waText(txt)}`;
      }
      form.addEventListener('change', update);
      notes.addEventListener('input', update);
      document.getElementById('vegClear').addEventListener('click', ()=>{ $$('input[name="ing"]').forEach(i=>{i.checked=false;i.disabled=false}); notes.value=''; update(); });
      update();
    }

    // Enlaces principales WA
    function setMainWaLinks(){
      const txt = waText('Hola Poly, me gustar√≠a pedir del men√∫ de esta semana. ');
      document.getElementById('btnHeader').href = `${waBase()}?text=${txt}`;
      document.getElementById('waFoot').href = `${waBase()}?text=${txt}`;
      document.getElementById('fabWa').href = `${waBase()}?text=${txt}`;
    }

    // INIT
    (function init(){
      setMainWaLinks();
      updateStateBadge(); setInterval(updateStateBadge, 60*1000);
      renderPlatoDelDia(); renderTabs(); renderCarousel(); renderPostres(); renderVeg();
      document.getElementById('year').textContent = new Date().getFullYear();
    })();
  </script>
</body>
</html>
